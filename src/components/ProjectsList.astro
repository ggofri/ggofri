---
// Import Astro's content collection API
import { getCollection } from 'astro:content';

// Fetch all projects from the content collection
const projects = await getCollection('projects');

// Sort projects by start date, most recent first
projects.sort((a, b) => {
  const aDate = a.data.startDate || new Date(0);
  const bDate = b.data.startDate || new Date(0);
  return bDate.valueOf() - aDate.valueOf();
});
---

<div class="space-y-6">
  {projects.map((project) => {
    const href = project.data.links?.[0]?.url || "#";
    const status = project.data.status === 'wip' ? 'in progress' : project.data.status;
    return (
      <a
        href={href}
        class="group block pb-6 border-b border-border/50 last:border-b-0 hover:opacity-70 transition-opacity"
      >
        <div class="flex items-start justify-between mb-2">
          <h2 class="text-base font-semibold group-hover:text-muted-foreground transition-colors">
            {project.data.title}
          </h2>
          <span class="text-xs text-muted-foreground flex-shrink-0 ml-4">{status}</span>
        </div>
        <p class="text-sm text-muted-foreground leading-relaxed">{project.data.description}</p>
      </a>
    );
  })}
</div>